import javax.json.*;
import java.io.FileWriter;
import java.util.HashMap;
import java.util.Map;

//TIP To <b>Run</b> code, press <shortcut actionId="Run"/> or
// click the <icon src="AllIcons.Actions.Execute"/> icon in the gutter.
public class Main {
    public static void main(String[] args) throws Exception {
        Map<String, Object> config = new HashMap<String, Object>();
        JsonBuilderFactory factory = Json.createBuilderFactory(config);
        JsonObject value = (JsonObject) factory.createObjectBuilder()
                .add("students", factory.createArrayBuilder()
                        .add(factory.createObjectBuilder()
                                .add("name", "John Doe")
                                .add("grades", factory.createObjectBuilder()
                                        .add("Math", 85)
                                        .add("Physics", 90)
                                        .add("Chemistry", 78)))
                        .add(factory.createObjectBuilder()
                                .add("name", "Jane Smith")
                                .add("grades", factory.createObjectBuilder()
                                        .add("Biology", 88)
                                        .add("Math", 92)
                                        .add("English", 81))))
                .build();
        JsonArray array = value.getJsonArray("students");
        JsonObject student1 = array.getJsonObject(0);
        JsonObject student2 = array.getJsonObject(1);
        JsonObject grade1 = student1.getJsonObject("grades");
        JsonObject grade2 = student2.getJsonObject("grades");
        int stu1average = (grade1.getInt("Math")+grade1.getInt("Physics")+grade1.getInt("Chemistry"))/3;
        int stu2average = (grade2.getInt("Biology")+grade2.getInt("Math")+grade2.getInt("English"))/3;
        int stu1rank;
        int stu2rank;
        if(stu1average > stu2average){
            stu1rank = 1;
            stu2rank = 2;
        }
        else{
            stu1rank = 2;
            stu2rank = 1;
        }
        value = (JsonObject) factory.createObjectBuilder()
                .add("students", factory.createArrayBuilder()
                        .add(factory.createObjectBuilder()
                                .add("name", "John Doe")
                                .add("grades", factory.createObjectBuilder()
                                        .add("Math", 85)
                                        .add("Physics", 90)
                                        .add("Chemistry", 78)
                                        .add("average_marks", stu1average))
                                .add("Class Rank", stu1rank))
                        .add(factory.createObjectBuilder()
                                .add("name", "Jane Smith")
                                .add("grades", factory.createObjectBuilder()
                                        .add("Biology", 88)
                                        .add("Math", 92)
                                        .add("English", 81)
                                        .add("average_marks", stu2average))
                                .add("Class Rank", stu2rank)))
                .build();
        FileWriter file = new FileWriter("updated_students.json");
        file.write(value.toString());
        file.close();
    }
}
